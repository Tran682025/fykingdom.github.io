<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <title>PiChordify Kingdom ‚Äî FYKINGDOM v0.4</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root {
      --bg: #0b0f1a;
      --panel: #111827;
      --panel-soft: #151b2c;
      --accent: #5b8dff;
      --accent-soft: #243b68;
      --accent-2: #22c55e;
      --danger: #ef4444;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --border: #1f2937;
      --radius-lg: 16px;
      --radius-md: 10px;
      --shadow-soft: 0 18px 40px rgba(0,0,0,.45);
      --font-ui: system-ui,-apple-system,BlinkMacSystemFont,"SF Pro Text",
                 "Segoe UI",Roboto,Inter,Arial,sans-serif;
      --font-mono: ui-monospace,Menlo,monospace;
    }

    * { box-sizing:border-box; }

    body {
      margin:0;
      min-height:100vh;
      font-family:var(--font-ui);
      background:radial-gradient(circle at top,#1f2937 0,#020617 55%);
      color:var(--text);
      display:flex;
      align-items:stretch;
      justify-content:center;
      padding:16px;
    }

    .app-shell {
      width:100%;
      max-width:1200px;
      background:linear-gradient(135deg,rgba(56,189,248,.14),rgba(129,140,248,.18));
      padding:1px;
      border-radius:24px;
      box-shadow:var(--shadow-soft);
    }

    .app-inner {
      border-radius:22px;
      background:radial-gradient(circle at top left,#111827 0,#020617 60%);
      padding:18px 20px 20px;
      display:flex;
      flex-direction:column;
      gap:14px;
    }

    header {
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }

    .brand {
      display:flex;
      align-items:center;
      gap:10px;
    }

    .brand-pill {
      width:32px;
      height:32px;
      border-radius:999px;
      background:radial-gradient(circle at 30% 20%,#facc15,#f97316);
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:700;
      color:#111827;
      font-size:18px;
    }

    .brand-text-title {
      font-weight:700;
      letter-spacing:.02em;
    }

    .brand-text-sub {
      font-size:12px;
      color:var(--muted);
    }

    .header-right {
      display:flex;
      align-items:center;
      gap:8px;
    }

    .badge {
      font-size:11px;
      padding:3px 9px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.7);
      color:var(--muted);
    }

    .btn {
      border:none;
      border-radius:999px;
      padding:7px 13px;
      font-size:13px;
      font-weight:500;
      cursor:pointer;
      background:rgba(15,23,42,.9);
      color:var(--text);
      border:1px solid var(--border);
      display:inline-flex;
      align-items:center;
      gap:6px;
      white-space:nowrap;
    }

    .btn span.icon { font-size:14px; }

    .btn-primary {
      background:linear-gradient(135deg,#4f46e5,#22c55e);
      border:none;
      color:white;
    }

    .btn-outline {
      background:transparent;
      border-color:rgba(148,163,184,.7);
      color:var(--muted);
    }

    .btn-premium {
      background:#16a34a;
      border:none;
      color:#ecfdf5;
      font-weight:600;
    }

    main {
      display:grid;
      grid-template-columns: minmax(0, 2.1fr) minmax(0, 1.3fr);
      gap:16px;
      margin-top:6px;
    }

    .panel {
      background:var(--panel);
      border-radius:var(--radius-lg);
      padding:14px 14px 16px;
      border:1px solid rgba(15,23,42,.9);
      box-shadow:0 14px 30px rgba(0,0,0,.5);
    }

    .panel-header {
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:10px;
      gap:8px;
    }

    .panel-title {
      font-weight:600;
      font-size:14px;
    }

    .tabs {
      display:flex;
      gap:6px;
      flex-wrap:wrap;
    }

    .tab {
      padding:5px 10px;
      font-size:12px;
      border-radius:999px;
      border:1px solid var(--border);
      background:var(--panel-soft);
      color:var(--muted);
      cursor:pointer;
      white-space:nowrap;
    }

    .tab.active {
      background:linear-gradient(135deg,#6366f1,#22c55e);
      border:none;
      color:white;
    }

    label {
      display:block;
      font-size:12px;
      color:var(--muted);
      margin-bottom:3px;
    }

    input[type="text"],
    input[type="number"],
    input[type="url"],
    textarea {
      width:100%;
      border-radius:var(--radius-md);
      border:1px solid var(--border);
      background:var(--panel-soft);
      color:var(--text);
      font-size:13px;
      padding:7px 9px;
      font-family:inherit;
      outline:none;
    }

    textarea {
      min-height:130px;
      resize:vertical;
      line-height:1.45;
    }

    input:focus,
    textarea:focus {
      border-color:#4f46e5;
      box-shadow:0 0 0 1px rgba(79,70,229,.4);
    }

    .field-group {
      margin-bottom:8px;
    }

    .btn-row {
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin:8px 0 10px;
    }

    .btn-xs {
      padding:5px 10px;
      font-size:12px;
    }

    .grid-2 {
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap:8px;
      margin-bottom:10px;
    }

    .audio-controls {
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      align-items:center;
      margin-top:4px;
    }

    .time-label {
      font-size:11px;
      color:var(--muted);
      margin-top:4px;
    }

    /* Console panel */

    .console {
      font-family:var(--font-mono);
      font-size:12px;
      background:#020617;
      border-radius:var(--radius-md);
      padding:10px 10px 12px;
      border:1px solid #1f2937;
      color:#e5e7eb;
      height:100%;
      min-height:210px;
      overflow:auto;
      white-space:pre-wrap;
    }

    .console-line {
      display:block;
      margin-bottom:3px;
    }
    .console-line .tag {
      margin-right:4px;
    }
    .console-line.info .tag { color:#38bdf8; }
    .console-line.warn .tag { color:#facc15; }
    .console-line.ok   .tag { color:#22c55e; }
    .console-line.err  .tag { color:#f97373; }

    footer {
      margin-top:6px;
      font-size:11px;
      color:var(--muted);
      text-align:right;
    }

    footer span {
      color:#e5e7eb;
      font-weight:500;
    }

    @media (max-width: 880px) {
      main {
        grid-template-columns: minmax(0,1fr);
      }
      body { padding:10px; }
      .app-inner { padding:14px 12px 16px; }
    }
  </style>
</head>
<body>
<div class="app-shell">
  <div class="app-inner">
    <header>
      <div class="brand">
        <div class="brand-pill">œÄ</div>
        <div>
          <div class="brand-text-title">PiChordify Kingdom</div>
          <div class="brand-text-sub">FYKINGDOM ¬∑ Demo core v0.4 ¬∑ Free tier</div>
        </div>
      </div>

      <div class="header-right">
        <div class="badge">Testnet ¬∑ Hackathon demo</div>
        <button class="btn btn-outline" id="btn-pi-login">
          <span class="icon">üîë</span> Pi Login
        </button>
        <button class="btn btn-outline" id="btn-check-premium">
          Ki·ªÉm tra Premium
        </button>
        <button class="btn btn-premium" id="btn-pay-premium">
          Thanh to√°n Premium
        </button>
      </div>
    </header>

    <main>
      <!-- LEFT: editor -->
      <section class="panel">
        <div class="panel-header">
          <div class="panel-title">Demo core v0.4</div>
          <div class="tabs">
            <button class="tab active">T·∫£i demo 1</button>
            <button class="tab">T·∫£i demo 2</button>
            <button class="tab" id="btn-clear">X√≥a demo</button>
          </div>
        </div>

        <div class="field-group">
          <label for="song-title">Ti√™u ƒë·ªÅ</label>
          <input id="song-title" type="text" placeholder="T√™n b√†i..." />
        </div>

        <div class="field-group">
          <label for="song-body">L·ªùi + h·ª£p √¢m (m·ªói d√≤ng c√≥ m·ªëc th·ªùi gian)</label>
          <textarea id="song-body" placeholder="mm:ss   n·ªôi dung / h·ª£p √¢m..."></textarea>
        </div>

        <div class="btn-row">
          <button class="btn btn-primary btn-xs" id="btn-compile">
            Bi√™n d·ªãch &amp; xem tr∆∞·ªõc
          </button>
          <button class="btn btn-xs" id="btn-export-srt">
            Export .srt
          </button>
          <button class="btn btn-xs" id="btn-export-pdf">
            Export PDF (Premium)
          </button>
        </div>

        <div class="grid-2">
          <div class="field-group">
            <label for="bpm">BPM (nh·ªãp)</label>
            <input id="bpm" type="number" value="80" min="20" max="260" />
          </div>
          <div class="field-group">
            <label for="offset">Offset (gi√¢y, +/-)</label>
            <input id="offset" type="number" value="0" step="0.1" />
          </div>
        </div>

        <div class="field-group">
          <label for="audio-url">URL audio (mp3)</label>
          <input id="audio-url" type="url" placeholder="https://...song.mp3" />
        </div>

        <div class="audio-controls">
          <button class="btn btn-xs" id="btn-load-audio">T·∫£i nh·∫°c</button>
          <button class="btn btn-xs" id="btn-play">Play</button>
          <button class="btn btn-xs" id="btn-pause">Pause</button>
          <button class="btn btn-xs" id="btn-stop">Stop</button>
          <button class="btn btn-xs" id="btn-metronome">Ph√°t nh·ªãp th·ª≠</button>
          <audio id="audio" preload="none" style="display:none;"></audio>
        </div>
        <div class="time-label" id="time-label">00:00</div>
      </section>

      <!-- RIGHT: console -->
      <section class="panel">
        <div class="panel-header">
          <div class="panel-title">SDK &amp; tr·∫°ng th√°i</div>
        </div>
        <div class="console" id="console">
          <!-- d√≤ng log s·∫Ω ƒë∆∞·ª£c JS ƒë·∫©y v√†o -->
        </div>
      </section>
    </main>

    <footer>
      ¬© <span>FYKINGDOM</span> ¬∑ Hackathon demo ‚Äúc√≥ nh·∫°c th·∫≠t‚Äù
    </footer>
  </div>
</div>

<script>
  // ===== Helpers =====
  function logConsole(type, msg) {
    const el = document.getElementById("console");
    const line = document.createElement("div");
    line.className = "console-line " + type;
    const tag = document.createElement("span");
    tag.className = "tag";
    tag.textContent =
      type === "ok" ? "‚úÖ" :
      type === "err" ? "‚ùå" :
      type === "warn" ? "‚ö†Ô∏è" : "üí¨";
    line.appendChild(tag);
    line.appendChild(document.createTextNode(" " + msg));
    el.appendChild(line);
    el.scrollTop = el.scrollHeight;
  }

  // Initial messages
  logConsole("ok", "Ready.");
  if (!window.Pi) {
    logConsole("warn", "Kh√¥ng ·ªü Pi Browser ‚Äì ·∫©n thanh to√°n. V√†o Pi Browser ƒë·ªÉ test SDK.");
  } else {
    logConsole("ok", "Pi SDK detected.");
  }
  logConsole("info", "DOM loaded. JS ƒëang ch·∫°y.");

  // ===== Editor actions =====
  const bodyEl = document.getElementById("song-body");

  document.getElementById("btn-clear").addEventListener("click", () => {
    bodyEl.value = "";
    logConsole("info", "ƒê√£ x√≥a n·ªôi dung demo.");
  });

  document.getElementById("btn-compile").addEventListener("click", () => {
    const title = document.getElementById("song-title").value.trim() || "(Kh√¥ng ti√™u ƒë·ªÅ)";
    const bpm = document.getElementById("bpm").value || "80";
    const lines = bodyEl.value.split(/\r?\n/).filter(Boolean).length;
    logConsole("ok", `Bi√™n d·ªãch xong: "${title}" ¬∑ ${lines} d√≤ng ¬∑ ${bpm} BPM.`);
  });

  document.getElementById("btn-export-srt").addEventListener("click", () => {
    logConsole("warn", "Export .srt: b·∫£n demo ch·ªâ log tr·∫°ng th√°i, ch∆∞a t·∫°o file th·∫≠t.");
  });

  document.getElementById("btn-export-pdf").addEventListener("click", () => {
    logConsole("warn", "Export PDF (Premium): s·∫Ω k√≠ch ho·∫°t sau khi t√≠ch h·ª£p Pi Payment.");
  });

  // ===== Audio controls (demo ƒë∆°n gi·∫£n) =====
  const audioEl = document.getElementById("audio");
  const timeLabel = document.getElementById("time-label");

  function formatTime(sec) {
    if (!isFinite(sec)) return "00:00";
    const m = Math.floor(sec / 60);
    const s = Math.floor(sec % 60);
    return String(m).padStart(2,"0") + ":" + String(s).padStart(2,"0");
  }

  document.getElementById("btn-load-audio").addEventListener("click", () => {
    const url = document.getElementById("audio-url").value.trim();
    if (!url) {
      logConsole("err", "Ch∆∞a nh·∫≠p URL audio.");
      return;
    }
    audioEl.src = url;
    audioEl.load();
    logConsole("ok", "ƒê√£ t·∫£i source audio (ch·ªâ demo, ch∆∞a ki·ªÉm tra CORS).");
  });

  document.getElementById("btn-play").addEventListener("click", () => {
    audioEl.play().then(() => {
      logConsole("ok", "Play audio.");
    }).catch(err => {
      logConsole("err", "Kh√¥ng play ƒë∆∞·ª£c audio: " + err.message);
    });
  });

  document.getElementById("btn-pause").addEventListener("click", () => {
    audioEl.pause();
    logConsole("info", "Pause audio.");
  });

  document.getElementById("btn-stop").addEventListener("click", () => {
    audioEl.pause();
    audioEl.currentTime = 0;
    logConsole("info", "Stop audio.");
  });

  audioEl.addEventListener("timeupdate", () => {
    timeLabel.textContent = formatTime(audioEl.currentTime);
  });

  document.getElementById("btn-metronome").addEventListener("click", () => {
    const bpm = Number(document.getElementById("bpm").value || 80);
    const interval = 60000 / bpm;
    logConsole("info", `Metronome demo: ${bpm} BPM (~1 tick m·ªói ${Math.round(interval)} ms).`);
  });

  // ===== Stub Pi actions =====
  document.getElementById("btn-pi-login").addEventListener("click", () => {
    if (!window.Pi) {
      logConsole("err", "Pi Login ch·ªâ ho·∫°t ƒë·ªông trong Pi Browser.");
      return;
    }
    logConsole("info", "S·∫Ω g·ªçi Pi.authenticate(...) ·ªü b·∫£n t√≠ch h·ª£p th·∫≠t.");
  });

  document.getElementById("btn-check-premium").addEventListener("click", () => {
    logConsole("info", "Ki·ªÉm tra Premium: demo hi·ªÉn th·ªã Free tier.");
  });

  document.getElementById("btn-pay-premium").addEventListener("click", () => {
    if (!window.Pi) {
      logConsole("err", "Pi Payment ch·ªâ ho·∫°t ƒë·ªông trong Pi Browser (Testnet).");
      return;
    }
    logConsole("info", "S·∫Ω m·ªü Pi.createPayment(...) b·∫£n Testnet ·ªü b∆∞·ªõc sau.");
  });
</script>
</body>
</html>
